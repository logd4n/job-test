# **Документация** 


## **Оглавление**

1. [Общее описание](#Общее%20описание)
    
3. [Технический стек](#технический-стек)
    
4. [Установка и запуск](#установка-и-запуск)
    
5. API Endpoints
	
6. Структура проекта
    
7. Разработка

---

## **Общее описание**

Тестовое задание.

Автор проекта: <b><u>LOG</u></b>  
---

## **Технический стек**

- **Язык:** Go 1.22.4+
- **Фреймворк:** стандартная библиотека net/http
- **База данных:** PostgreSQL
- **ORM:** gorm.io/gorm
- **Драйвер для БД** gorm.io/driver/postgres v1.6.0	
- **Контейнеризация:** Docker, docker-compose


---

## Установка и запуск

### Предварительные требования
- Go 1.22.4 или выше
- PostgreSQL 12+
---

### Шаги установки

#### 1. **Клонирование репозитория**
   ```bash
   git clone https://github.com/logd4n/cookbook.git

   cd cookbook
   ```

#### 2. **Настройка базы данных**
   ```sql
   CREATE DATABASE cookbook;
   CREATE TABLE recipes (
       id SERIAL PRIMARY KEY,
       name TEXT NOT NULL,
       category TEXT NOT NULL,
       ingredients TEXT[] NOT NULL,
       instructions TEXT NOT NULL,
       );
   ```

#### 3. **Настройка окружения**

   #### 3.1 **Dockerfile (можно не настраивать)**
   
   Образ с Go 1.22.4+. В проекте я использовал образ golang:1.22.4-alpine для экономии памяти.

   Рабочая директория:
   ```Dockerfile
   WORKDIR /app <-- можно использовать свой каталог 
   ``` 

   Компиляция, выдача прав и запуск:
   ```Dockerfile
   RUN CGO_ENABLED=0 go build -ldflags="-w -s" -o cookbook ./cmd/main.go
   RUN chmod +x cookbook
   CMD ["./cookbook"]
   ```
   `Можете изменить название исполняемого файла`

   #### 3.2 **docker-compose**

   Убираем "(example)" из имени файла:
   ```
   docker-compose (example).yml --> docker-compose.yml
   ```
   #### а. Настраиваем сервис БД
   Задаем имя сервиса:
   ```yml
   database: #можно указать своё
   ```
   Выбираем образ:
   ```yml
   image: postgres:15

   postgres #Имя образа БД
   15 #Версия
   ```

   ``В проекте используется postgres:17.5``

   Настраиваем окружение:
   ```yml
   environment:
      POSTGRES_USER: username #указываем имя пользователя для работы с БД
      POSTGRES_PASSWORD: 1234567890 #пароль для доступа к БД
      POSTGRES_DB: test #имя БД 
   ```

   Указываем порты для соединения (хост:контейнер):
   ```yml
   ports:
      - "0000:0000" #Стандартный порт - 5432 (5432:5432)
   ```

   Указываем том для сохранения данных:
   ```yml
   volumes:
      - postgres_data:/var/lib/postgresql/data
   ```

   ``В файле уже указан данный путь, поэтому не меняем.``

   #### b. Настраиваем сервис веб-приложения

   Задаем имя сервиса:
   ```yml
   app: #можно указать своё
   ```
   Выбираем образ:
   ```yml
   image: app:1.0

   app #Имя образа веб-приложения
   1.0 #Тэг (версия)
   ```

   Настраиваем автосборку:
   ```yml
   build: .
   ```

   Указываем порты для работы (хост:контейнер):
   ```yml
   ports:
      - "0000:0000" #Стандартный порт - 8080 (8080:8080)
   ```

   Настраиваем окружение:
   ```yml
   environment:
      APP_VERSION: 1.0.0 #версия приложения
      SERVER_ADDR: 192.168.0.2:0000 #указываем адрес хоста и порт
      DB_USER: username #указываем имя пользователя для работы с БД
      DB_NAME: test #имя БД
      DB_PASS: 1234567890 #пароль для доступа к БД
      DB_HOST: database #указываем название сервиса БД
      DB_PORT: 0000 #указываем порт, на котром работает сервис БД (хост:контейнер)
      DB_SSLMODE: disable #выбираем SSL-мод
   ```

   Настраиваем запуск веб-приложения после запуска БД:
   ```yml
   depends_on:
      - database #имя сервиса БД
   ```

   #### c. Настраиваем тома для хранения данных
   
   ```yml
   volumes:
      postgres_data: #имя тома БД
   ```

   #### <br>4. **Запуск сервера**</br>
   
   ```bash
   docker-compose up -d --build
   ```

   #### <br>5. **Доступ к приложению**</br>
   - Локально: http://localhost:8080
   - В сети: http://[ваш-ip]:8080

